import { useEffect, useRef } from "react";

interface AnimatedLineProps {
  className?: string;
  principleNumber: number;
}

// Function to generate unique path for each principle using full viewport height
const generatePrinciplePath = (principleNumber: number): string => {
  const paths = {
    // Decentralized: Sophisticated network pattern with horizontal lines, verticals, and arrow-like flows
    1: "M0 480 L1340 480 C1345 480, 1350 475, 1350 470 L1350 20 C1350 10, 1360 8, 1365 15 L1470 190 C1473 195, 1470 200, 1465 200 L1410 200 C1405 200, 1400 205, 1400 210 L1400 750 C1400 760, 1410 762, 1413 755 L1470 580 C1472 575, 1470 570, 1465 570 L1445 570 C1440 570, 1435 565, 1435 560 L1435 490 C1435 485, 1440 480, 1445 480 L1920 480",
    
    // Empowering: Lightning bolt/thunder strike representing power, energy, and impactful force
    2: "M0 630 L300 630 C305 630, 310 625, 310 620 L310 400 L480 400 L380 200 L580 200 L450 80 L650 80 L520 20 L720 20 L1200 350 L1050 350 L1180 500 L980 500 L1120 650 L920 650 L1050 750 L1250 750 C1255 750, 1260 745, 1260 740 L1260 520 C1260 515, 1265 510, 1270 510 L1450 510 C1455 510, 1460 515, 1460 520 L1460 600 C1460 605, 1465 610, 1470 610 L1650 610 C1655 610, 1660 615, 1660 620 L1660 630 L1920 630",
    
    // Transparent: Clear sight lines with layered glass-like structure showing progressive disclosure
    3: "M0 150 L480 150 C485 150, 490 155, 490 160 L490 280 C490 285, 495 290, 500 290 L720 290 C725 290, 730 295, 730 300 L730 420 C730 425, 735 430, 740 430 L960 430 C965 430, 970 435, 970 440 L970 560 C970 565, 975 570, 980 570 L1200 570 C1205 570, 1210 565, 1210 560 L1210 440 C1210 435, 1215 430, 1220 430 L1440 430 C1445 430, 1450 425, 1450 420 L1450 300 C1450 295, 1455 290, 1460 290 L1680 290 C1685 290, 1690 285, 1690 280 L1690 160 C1690 155, 1695 150, 1700 150 L1920 150",
    
    // Secure: Key shape representing access control, protection, and security
    4: "M0 340 L200 340 C205 340, 210 345, 210 350 L210 450 C210 500, 250 540, 300 540 L400 540 C450 540, 490 500, 490 450 L490 350 C490 300, 450 260, 400 260 L300 260 C250 260, 210 300, 210 350 C210 345, 215 340, 220 340 L300 340 C305 340, 310 345, 310 350 C310 355, 315 360, 320 360 L1200 360 C1205 360, 1210 365, 1210 370 L1210 420 C1210 425, 1215 430, 1220 430 L1320 430 C1325 430, 1330 425, 1330 420 L1330 370 C1330 365, 1335 360, 1340 360 L1400 360 C1405 360, 1410 365, 1410 370 L1410 320 C1410 315, 1415 310, 1420 310 L1480 310 C1485 310, 1490 315, 1490 320 L1490 370 C1490 375, 1495 380, 1500 380 L1560 380 C1565 380, 1570 375, 1570 370 L1570 320 C1570 315, 1575 310, 1580 310 L1640 310 C1645 310, 1650 315, 1650 320 L1650 370 C1650 375, 1655 380, 1660 380 L1720 380 C1725 380, 1730 375, 1730 370 L1730 320 C1730 315, 1735 310, 1740 310 L1800 310 C1805 310, 1810 315, 1810 320 L1810 340 L1920 340",
    
    // Trustworthy: Solid, reliable foundation building upward with consistent patterns
    5: "M0 300 L160 300 C165 300, 170 305, 170 310 L170 250 C170 245, 175 240, 180 240 L320 240 C325 240, 330 245, 330 250 L330 190 C330 185, 335 180, 340 180 L480 180 C485 180, 490 185, 490 190 L490 130 C490 125, 495 120, 500 120 L640 120 C645 120, 650 125, 650 130 L650 70 C650 65, 655 60, 660 60 L800 60 C805 60, 810 65, 810 70 L810 130 C810 135, 815 140, 820 140 L960 140 C965 140, 970 135, 970 130 L970 190 C970 195, 975 200, 980 200 L1120 200 C1125 200, 1130 195, 1130 190 L1130 250 C1130 255, 1135 260, 1140 260 L1280 260 C1285 260, 1290 255, 1290 250 L1290 310 C1290 315, 1295 320, 1300 320 L1440 320 C1445 320, 1450 315, 1450 310 L1450 370 C1450 375, 1455 380, 1460 380 L1600 380 C1605 380, 1610 375, 1610 370 L1610 430 C1610 435, 1615 440, 1620 440 L1760 440 C1765 440, 1770 435, 1770 430 L1770 490 C1770 495, 1775 500, 1780 500 L1920 500",
    
    // Accessible: Multiple entry points with ramps and gentle slopes for everyone
    6: "M0 750 L240 750 C245 750, 250 745, 250 740 L250 680 C250 675, 255 670, 260 670 L400 670 C405 670, 410 665, 410 660 L410 600 C410 595, 415 590, 420 590 L560 590 C565 590, 570 585, 570 580 L570 520 C570 515, 575 510, 580 510 L720 510 C725 510, 730 505, 730 500 L730 440 C730 435, 735 430, 740 430 L880 430 C885 430, 890 425, 890 420 L890 360 C890 355, 895 350, 900 350 L1040 350 C1045 350, 1050 345, 1050 340 L1050 280 C1050 275, 1055 270, 1060 270 L1200 270 C1205 270, 1210 275, 1210 280 L1210 320 C1210 325, 1215 330, 1220 330 L1360 330 C1365 330, 1370 335, 1370 340 L1370 400 C1370 405, 1375 410, 1380 410 L1520 410 C1525 410, 1530 415, 1530 420 L1530 480 C1530 485, 1535 490, 1540 490 L1680 490 C1685 490, 1690 495, 1690 500 L1690 560 C1690 565, 1695 570, 1700 570 L1840 570 C1845 570, 1850 575, 1850 580 L1850 640 C1850 645, 1855 650, 1860 650 L1920 650",
    
    // Inclusive: Multiple parallel paths for different backgrounds converging and diverging
    7: "M0 100 L280 100 C285 100, 290 105, 290 110 L290 200 C290 205, 295 210, 300 210 L480 210 C485 210, 490 215, 490 220 L490 300 C490 305, 495 310, 500 310 L680 310 C685 310, 690 305, 690 300 L690 220 C690 215, 695 210, 700 210 L880 210 C885 210, 890 215, 890 220 L890 400 C890 405, 895 410, 900 410 L1080 410 C1085 410, 1090 415, 1090 420 L1090 500 C1090 505, 1095 510, 1100 510 L1280 510 C1285 510, 1290 505, 1290 500 L1290 420 C1290 415, 1295 410, 1300 410 L1480 410 C1485 410, 1490 405, 1490 400 L1490 320 C1490 315, 1495 310, 1500 310 L1680 310 C1685 310, 1690 315, 1690 320 L1690 400 C1690 405, 1695 410, 1700 410 L1880 410 C1885 410, 1890 415, 1890 420 L1890 500 C1890 505, 1895 510, 1900 510 L1920 510",
    
    // Open: Connecting bridges and collaborative junction points with shared pathways
    8: "M0 600 L200 600 C205 600, 210 595, 210 590 L210 400 C210 395, 215 390, 220 390 L420 390 C425 390, 430 385, 430 380 L430 200 C430 195, 435 190, 440 190 L640 190 C645 190, 650 195, 650 200 L650 300 C650 305, 655 310, 660 310 L760 310 C765 310, 770 305, 770 300 L770 200 C770 195, 775 190, 780 190 L980 190 C985 190, 990 195, 990 200 L990 380 C990 385, 995 390, 1000 390 L1200 390 C1205 390, 1210 395, 1210 400 L1210 500 C1210 505, 1215 510, 1220 510 L1420 510 C1425 510, 1430 505, 1430 500 L1430 300 C1430 295, 1435 290, 1440 290 L1640 290 C1645 290, 1650 295, 1650 300 L1650 400 C1650 405, 1655 410, 1660 410 L1860 410 C1865 410, 1870 415, 1870 420 L1870 520 C1870 525, 1875 530, 1880 530 L1920 530",
    
    // Impactful: Strong directional force with focused energy and purposeful momentum
    9: "M0 400 L160 400 C165 400, 170 395, 170 390 L170 300 C170 295, 175 290, 180 290 L340 290 C345 290, 350 285, 350 280 L350 200 C350 195, 355 190, 360 190 L520 190 C525 190, 530 185, 530 180 L530 120 C530 115, 535 110, 540 110 L700 110 C705 110, 710 105, 710 100 L710 60 C710 50, 720 48, 723 55 L800 180 C802 185, 800 190, 795 190 L760 190 C755 190, 750 195, 750 200 L750 280 C750 285, 755 290, 760 290 L920 290 C925 290, 930 295, 930 300 L930 380 C930 385, 935 390, 940 390 L1100 390 C1105 390, 1110 395, 1110 400 L1110 480 C1110 485, 1115 490, 1120 490 L1280 490 C1285 490, 1290 495, 1290 500 L1290 580 C1290 585, 1295 590, 1300 590 L1460 590 C1465 590, 1470 595, 1470 600 L1470 680 C1470 685, 1475 690, 1480 690 L1640 690 C1645 690, 1650 695, 1650 700 L1650 780 C1650 785, 1655 790, 1660 790 L1920 790",
    
    // Future-proof: Modular adaptable structure with flexible joints and expandable framework
    10: "M0 480 L160 480 C165 480, 170 475, 170 470 L170 380 C170 370, 180 368, 183 375 L220 440 C222 445, 220 450, 215 450 L180 450 C175 450, 170 455, 170 460 L170 540 C170 545, 175 550, 180 550 L320 550 C325 550, 330 545, 330 540 L330 460 C330 455, 335 450, 340 450 L480 450 C485 450, 490 455, 490 460 L490 540 C490 545, 495 550, 500 550 L640 550 C645 550, 650 545, 650 540 L650 360 C650 350, 660 348, 663 355 L720 460 C722 465, 720 470, 715 470 L680 470 C675 470, 670 475, 670 480 L670 560 C670 565, 675 570, 680 570 L820 570 C825 570, 830 565, 830 560 L830 480 C830 475, 835 470, 840 470 L980 470 C985 470, 990 475, 990 480 L990 560 C990 565, 995 570, 1000 570 L1140 570 C1145 570, 1150 565, 1150 560 L1150 380 C1150 370, 1160 368, 1163 375 L1220 480 C1222 485, 1220 490, 1215 490 L1180 490 C1175 490, 1170 495, 1170 500 L1170 580 C1170 585, 1175 590, 1180 590 L1320 590 C1325 590, 1330 585, 1330 580 L1330 500 C1330 495, 1335 490, 1340 490 L1480 490 C1485 490, 1490 495, 1490 500 L1490 580 C1490 585, 1495 590, 1500 590 L1640 590 C1645 590, 1650 585, 1650 580 L1650 500 C1650 495, 1655 490, 1660 490 L1800 490 C1805 490, 1810 495, 1810 500 L1810 580 C1810 585, 1815 590, 1820 590 L1920 590"
  };
  
  return paths[principleNumber as keyof typeof paths] || paths[1];
};

export default function AnimatedLine({ className = "", principleNumber }: AnimatedLineProps) {
  const pathRef = useRef<SVGPathElement>(null);

  useEffect(() => {
    const path = pathRef.current;
    if (!path) return;

    // Clear any existing transition first
    path.style.transition = 'none';
    
    // Force a reflow to ensure the new path is rendered
    path.getBoundingClientRect();
    
    const pathLength = path.getTotalLength();
    
    // Set initial state (line hidden)
    path.style.strokeDasharray = `${pathLength}`;
    path.style.strokeDashoffset = `${pathLength}`;
    
    // Animate the line after a short delay
    const timer = setTimeout(() => {
      path.style.transition = 'stroke-dashoffset 1s ease-in-out';
      path.style.strokeDashoffset = '0';
    }, 100);

    return () => {
      clearTimeout(timer);
      // Reset transition when component unmounts or principle changes
      if (path) {
        path.style.transition = 'none';
      }
    };
  }, [principleNumber]); // Re-animate when principle changes

  return (
    <div className="fixed inset-0 pointer-events-none z-0">
      <svg 
        className={`w-full h-full ${className}`} 
        viewBox="0 0 1920 800" 
        fill="none" 
        xmlns="http://www.w3.org/2000/svg"
        preserveAspectRatio="none"
      >
        <path
          ref={pathRef}
          d={generatePrinciplePath(principleNumber)}
          stroke="hsl(var(--accent))"
          strokeWidth="3"
          strokeLinecap="round"
          strokeLinejoin="round"
          fill="none"
          opacity="0.4"
        />
      </svg>
    </div>
  );
}