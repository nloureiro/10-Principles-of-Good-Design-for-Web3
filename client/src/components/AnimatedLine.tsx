import { useEffect, useRef } from "react";

interface AnimatedLineProps {
  className?: string;
  principleNumber: number;
}

// Function to generate unique path for each principle using full viewport height
const generatePrinciplePath = (principleNumber: number): string => {
  const paths = {
    // Decentralized: Sophisticated network pattern with horizontal lines, verticals, and arrow-like flows
    1: "M0 360 L1340 360 C1345 360, 1350 355, 1350 350 L1350 15 C1350 8, 1360 6, 1365 12 L1470 143 C1473 147, 1470 150, 1465 150 L1410 150 C1405 150, 1400 155, 1400 160 L1400 563 C1400 570, 1410 572, 1413 567 L1470 435 C1472 432, 1470 428, 1465 428 L1445 428 C1440 428, 1435 425, 1435 420 L1435 368 C1435 365, 1440 360, 1445 360 L1920 360",
    
    // Empowering: Lightning bolt pattern using exact path from user's SVG
    2: "M0 407H950L1184.13 1.46924H1464L1344 173H1436L1252 407H1416L828 781L1234.27 97.6154H1476H1564H1908",
    
    // Transparent: Clear sight lines with layered glass-like structure showing progressive disclosure
    3: "M0 113 L480 113 C485 113, 490 117, 490 120 L490 210 C490 215, 495 218, 500 218 L720 218 C725 218, 730 222, 730 225 L730 315 C730 320, 735 323, 740 323 L960 323 C965 323, 970 327, 970 330 L970 420 C970 425, 975 428, 980 428 L1200 428 C1205 428, 1210 425, 1210 420 L1210 330 C1210 327, 1215 323, 1220 323 L1440 323 C1445 323, 1450 320, 1450 315 L1450 225 C1450 222, 1455 218, 1460 218 L1680 218 C1685 218, 1690 215, 1690 210 L1690 120 C1690 117, 1695 113, 1700 113 L1920 113",
    
    // Secure: Key shape representing access control, protection, and security
    4: "M0 255 L200 255 C205 255, 210 259, 210 263 L210 338 C210 375, 250 405, 300 405 L400 405 C450 405, 490 375, 490 338 L490 263 C490 225, 450 195, 400 195 L300 195 C250 195, 210 225, 210 263 C210 259, 215 255, 220 255 L300 255 C305 255, 310 259, 310 263 C310 267, 315 270, 320 270 L1200 270 C1205 270, 1210 274, 1210 278 L1210 315 C1210 320, 1215 323, 1220 323 L1320 323 C1325 323, 1330 320, 1330 315 L1330 278 C1330 274, 1335 270, 1340 270 L1400 270 C1405 270, 1410 274, 1410 278 L1410 240 C1410 237, 1415 233, 1420 233 L1480 233 C1485 233, 1490 237, 1490 240 L1490 278 C1490 282, 1495 285, 1500 285 L1560 285 C1565 285, 1570 282, 1570 278 L1570 240 C1570 237, 1575 233, 1580 233 L1640 233 C1645 233, 1650 237, 1650 240 L1650 278 C1650 282, 1655 285, 1660 285 L1720 285 C1725 285, 1730 282, 1730 278 L1730 240 C1730 237, 1735 233, 1740 233 L1800 233 C1805 233, 1810 237, 1810 240 L1810 255 L1920 255",
    
    // Trustworthy: Solid, reliable foundation building upward with consistent patterns
    5: "M0 225 L160 225 C165 225, 170 230, 170 233 L170 188 C170 185, 175 180, 180 180 L320 180 C325 180, 330 185, 330 188 L330 143 C330 140, 335 135, 340 135 L480 135 C485 135, 490 140, 490 143 L490 98 C490 95, 495 90, 500 90 L640 90 C645 90, 650 95, 650 98 L650 53 C650 50, 655 45, 660 45 L800 45 C805 45, 810 50, 810 53 L810 98 C810 102, 815 105, 820 105 L960 105 C965 105, 970 102, 970 98 L970 143 C970 147, 975 150, 980 150 L1120 150 C1125 150, 1130 147, 1130 143 L1130 188 C1130 192, 1135 195, 1140 195 L1280 195 C1285 195, 1290 192, 1290 188 L1290 233 C1290 237, 1295 240, 1300 240 L1440 240 C1445 240, 1450 237, 1450 233 L1450 278 C1450 282, 1455 285, 1460 285 L1600 285 C1605 285, 1610 282, 1610 278 L1610 323 C1610 327, 1615 330, 1620 330 L1760 330 C1765 330, 1770 327, 1770 323 L1770 368 C1770 372, 1775 375, 1780 375 L1920 375",
    
    // Accessible: Multiple entry points with ramps and gentle slopes for everyone
    6: "M0 563 L240 563 C245 563, 250 559, 250 555 L250 510 C250 507, 255 503, 260 503 L400 503 C405 503, 410 499, 410 495 L410 450 C410 447, 415 443, 420 443 L560 443 C565 443, 570 439, 570 435 L570 390 C570 387, 575 383, 580 383 L720 383 C725 383, 730 379, 730 375 L730 330 C730 327, 735 323, 740 323 L880 323 C885 323, 890 319, 890 315 L890 270 C890 267, 895 263, 900 263 L1040 263 C1045 263, 1050 259, 1050 255 L1050 210 C1050 207, 1055 203, 1060 203 L1200 203 C1205 203, 1210 207, 1210 210 L1210 240 C1210 245, 1215 248, 1220 248 L1360 248 C1365 248, 1370 252, 1370 255 L1370 300 C1370 305, 1375 308, 1380 308 L1520 308 C1525 308, 1530 312, 1530 315 L1530 360 C1530 365, 1535 368, 1540 368 L1680 368 C1685 368, 1690 372, 1690 375 L1690 420 C1690 425, 1695 428, 1700 428 L1840 428 C1845 428, 1850 432, 1850 435 L1850 480 C1850 485, 1855 488, 1860 488 L1920 488",
    
    // Inclusive: Multiple parallel paths for different backgrounds converging and diverging
    7: "M0 75 L280 75 C285 75, 290 79, 290 83 L290 150 C290 155, 295 158, 300 158 L480 158 C485 158, 490 162, 490 165 L490 225 C490 230, 495 233, 500 233 L680 233 C685 233, 690 230, 690 225 L690 165 C690 162, 695 158, 700 158 L880 158 C885 158, 890 162, 890 165 L890 300 C890 305, 895 308, 900 308 L1080 308 C1085 308, 1090 312, 1090 315 L1090 375 C1090 380, 1095 383, 1100 383 L1280 383 C1285 383, 1290 380, 1290 375 L1290 315 C1290 312, 1295 308, 1300 308 L1480 308 C1485 308, 1490 305, 1490 300 L1490 240 C1490 237, 1495 233, 1500 233 L1680 233 C1685 233, 1690 237, 1690 240 L1690 300 C1690 305, 1695 308, 1700 308 L1880 308 C1885 308, 1890 312, 1890 315 L1890 375 C1890 380, 1895 383, 1900 383 L1920 383",
    
    // Open: Connecting bridges and collaborative junction points with shared pathways
    8: "M0 450 L200 450 C205 450, 210 447, 210 443 L210 300 C210 297, 215 293, 220 293 L420 293 C425 293, 430 289, 430 285 L430 150 C430 147, 435 143, 440 143 L640 143 C645 143, 650 147, 650 150 L650 225 C650 230, 655 233, 660 233 L760 233 C765 233, 770 230, 770 225 L770 150 C770 147, 775 143, 780 143 L980 143 C985 143, 990 147, 990 150 L990 285 C990 290, 995 293, 1000 293 L1200 293 C1205 293, 1210 297, 1210 300 L1210 375 C1210 380, 1215 383, 1220 383 L1420 383 C1425 383, 1430 380, 1430 375 L1430 225 C1430 222, 1435 218, 1440 218 L1640 218 C1645 218, 1650 222, 1650 225 L1650 300 C1650 305, 1655 308, 1660 308 L1860 308 C1865 308, 1870 312, 1870 315 L1870 390 C1870 395, 1875 398, 1880 398 L1920 398",
    
    // Impactful: Strong directional force with focused energy and purposeful momentum
    9: "M0 300 L160 300 C165 300, 170 297, 170 293 L170 225 C170 222, 175 218, 180 218 L340 218 C345 218, 350 214, 350 210 L350 150 C350 147, 355 143, 360 143 L520 143 C525 143, 530 139, 530 135 L530 90 C530 87, 535 83, 540 83 L700 83 C705 83, 710 79, 710 75 L710 45 C710 38, 720 36, 723 42 L800 135 C802 140, 800 143, 795 143 L760 143 C755 143, 750 147, 750 150 L750 210 C750 215, 755 218, 760 218 L920 218 C925 218, 930 222, 930 225 L930 285 C930 290, 935 293, 940 293 L1100 293 C1105 293, 1110 297, 1110 300 L1110 360 C1110 365, 1115 368, 1120 368 L1280 368 C1285 368, 1290 372, 1290 375 L1290 435 C1290 440, 1295 443, 1300 443 L1460 443 C1465 443, 1470 447, 1470 450 L1470 510 C1470 515, 1475 518, 1480 518 L1640 518 C1645 518, 1650 522, 1650 525 L1650 585 C1650 590, 1655 593, 1660 593 L1920 593",
    
    // Future-proof: Modular adaptable structure with flexible joints and expandable framework
    10: "M0 360 L160 360 C165 360, 170 357, 170 353 L170 285 C170 278, 180 276, 183 282 L220 330 C222 335, 220 338, 215 338 L180 338 C175 338, 170 342, 170 345 L170 405 C170 410, 175 413, 180 413 L320 413 C325 413, 330 410, 330 405 L330 345 C330 342, 335 338, 340 338 L480 338 C485 338, 490 342, 490 345 L490 405 C490 410, 495 413, 500 413 L640 413 C645 413, 650 410, 650 405 L650 270 C650 263, 660 261, 663 267 L720 345 C722 350, 720 353, 715 353 L680 353 C675 353, 670 357, 670 360 L670 420 C670 425, 675 428, 680 428 L820 428 C825 428, 830 425, 830 420 L830 360 C830 357, 835 353, 840 353 L980 353 C985 353, 990 357, 990 360 L990 420 C990 425, 995 428, 1000 428 L1140 428 C1145 428, 1150 425, 1150 420 L1150 285 C1150 278, 1160 276, 1163 282 L1220 360 C1222 365, 1220 368, 1215 368 L1180 368 C1175 368, 1170 372, 1170 375 L1170 435 C1170 440, 1175 443, 1180 443 L1320 443 C1325 443, 1330 440, 1330 435 L1330 375 C1330 372, 1335 368, 1340 368 L1480 368 C1485 368, 1490 372, 1490 375 L1490 435 C1490 440, 1495 443, 1500 443 L1640 443 C1645 443, 1650 440, 1650 435 L1650 375 C1650 372, 1655 368, 1660 368 L1800 368 C1805 368, 1810 372, 1810 375 L1810 435 C1810 440, 1815 443, 1820 443 L1920 443"
  };
  
  return paths[principleNumber as keyof typeof paths] || paths[1];
};

export default function AnimatedLine({ className = "", principleNumber }: AnimatedLineProps) {
  const pathRef = useRef<SVGPathElement>(null);

  useEffect(() => {
    const path = pathRef.current;
    if (!path) return;

    // Clear any existing transition first
    path.style.transition = 'none';
    
    // Force a reflow to ensure the new path is rendered
    path.getBoundingClientRect();
    
    const pathLength = path.getTotalLength();
    
    // Set initial state (line hidden)
    path.style.strokeDasharray = `${pathLength}`;
    path.style.strokeDashoffset = `${pathLength}`;
    
    // Animate the line after a short delay
    const timer = setTimeout(() => {
      path.style.transition = 'stroke-dashoffset 1s ease-in-out';
      path.style.strokeDashoffset = '0';
    }, 100);

    return () => {
      clearTimeout(timer);
      // Reset transition when component unmounts or principle changes
      if (path) {
        path.style.transition = 'none';
      }
    };
  }, [principleNumber]); // Re-animate when principle changes

  return (
    <div className="absolute top-16 left-0 right-0 h-[500px] pointer-events-none z-0">
      <svg 
        className={`w-full h-full ${className}`} 
        viewBox="0 0 1920 800" 
        fill="none" 
        xmlns="http://www.w3.org/2000/svg"
        preserveAspectRatio="none"
      >
        <path
          ref={pathRef}
          d={generatePrinciplePath(principleNumber)}
          stroke="hsl(var(--accent))"
          strokeWidth="3"
          strokeLinecap="round"
          strokeLinejoin="round"
          fill="none"
          opacity="0.4"
        />
      </svg>
    </div>
  );
}